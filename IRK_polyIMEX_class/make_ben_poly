# TODO : right now only works with one driver file in the makefile at a time;
# Need to figure out how to have funcitoning makefile for multiple drivers..
# Problem is executable needs to be in the list of source files, probably to
# have it in the list of object files, but cannot have multiple executables
# in the object files as they interdepend


# Compiler, compile options, and link options

# Ben's stuff
MFEM_DIR  = /Users/southworth/Software/mfem
HYPRE_DIR = $(MFEM_DIR)/../hypre/src/hypre
METIS_DIR = $(MFEM_DIR)/../metis-5.1.0/build/Darwin-x86_64
CXX      = mpicxx
FLAGS    = -g -std=c++14 -fopenmp
INC      = -I$(MFEM_DIR)/bens_build -I$(HYPRE_DIR)/include -I$(METIS_DIR)/include -I./
CXXFLAGS = $(FLAGS) $(INC)
LDFLAGS  = -L$(MFEM_DIR)/bens_build -L$(HYPRE_DIR)/lib -L$(METIS_DIR)/libmetis
LDLIBS   = -lmfem -lHYPRE -lmetis

# Files to compile
# SOURCE_FILES   = $(wildcard *.cpp)
SOURCE_FILES   = FDSpaceDisc.cpp IRK_utils.cpp IRK.cpp imex-dg-adv-diff.cpp
EXEC_FILES     = imex-dg-adv-diff 
# SOURCE_FILES   = FDSpaceDisc.cpp IRK_utils.cpp IRK.cpp driver_adv_dif_FD.cpp
# EXEC_FILES     = driver_adv_dif_FD
OBJECT_FILES   = $(SOURCE_FILES:.cpp=.o)


$(EXEC_FILES): $(OBJECT_FILES)
	$(CXX) $(CXXFLAGS) -o $@ $(OBJECT_FILES) $(LDFLAGS) $(LDLIBS)

IRK.o : IRK.cpp IRK.hpp IRK_utils.hpp
	$(CXX) $(CXXFLAGS) -c IRK.cpp $(LDFLAGS) $(LDLIBS)

FDSpaceDisc.o : FDSpaceDisc.cpp FDSpaceDisc.hpp
	$(CXX) $(CXXFLAGS) -c FDSpaceDisc.cpp $(LDFLAGS) $(LDLIBS)

IRK_utils.o : IRK_utils.cpp IRK_utils.hpp
	$(CXX) $(CXXFLAGS) -c IRK_utils.cpp $(LDFLAGS) $(LDLIBS)

.PHONY: clean 

# Remove all object files and executables
clean:
	rm -f *.o $(EXEC_FILES)
	rm -rf *.dSYM *.TVD.*breakpoints

